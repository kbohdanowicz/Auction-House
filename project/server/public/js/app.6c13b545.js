(function(t){function e(e){for(var r,s,o=e[0],u=e[1],c=e[2],l=0,m=[];l<o.length;l++)s=o[l],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&m.push(n[s][0]),n[s]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(t[r]=u[r]);d&&d(e);while(m.length)m.shift()();return i.push.apply(i,c||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],r=!0,s=1;s<a.length;s++){var u=a[s];0!==n[u]&&(r=!1)}r&&(i.splice(e--,1),t=o(o.s=a[0]))}return t}var r={},n={app:0},i=[];function s(t){return o.p+"js/"+({}[t]||t)+"."+{"chunk-2d213e2d":"e0e455c2"}[t]+".js"}function o(e){if(r[e])return r[e].exports;var a=r[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.e=function(t){var e=[],a=n[t];if(0!==a)if(a)e.push(a[2]);else{var r=new Promise((function(e,r){a=n[t]=[e,r]}));e.push(a[2]=r);var i,u=document.createElement("script");u.charset="utf-8",u.timeout=120,o.nc&&u.setAttribute("nonce",o.nc),u.src=s(t);var c=new Error;i=function(e){u.onerror=u.onload=null,clearTimeout(l);var a=n[t];if(0!==a){if(a){var r=e&&("load"===e.type?"missing":e.type),i=e&&e.target&&e.target.src;c.message="Loading chunk "+t+" failed.\n("+r+": "+i+")",c.name="ChunkLoadError",c.type=r,c.request=i,a[1](c)}n[t]=void 0}};var l=setTimeout((function(){i({type:"timeout",target:u})}),12e4);u.onerror=u.onload=i,document.head.appendChild(u)}return Promise.all(e)},o.m=t,o.c=r,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(a,r,function(e){return t[e]}.bind(null,r));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/",o.oe=function(t){throw console.error(t),t};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],c=u.push.bind(u);u.push=e,u=u.slice();for(var l=0;l<u.length;l++)e(u[l]);var d=c;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},1:function(t,e){},1536:function(t,e,a){},2004:function(t,e,a){},"222f":function(t,e,a){},"2df4":function(t,e,a){"use strict";var r=a("9490"),n=a.n(r);n.a},"3fa4":function(t,e,a){},"3fc8":function(t,e,a){"use strict";var r=a("222f"),n=a.n(r);n.a},"41c0":function(t,e,a){"use strict";var r=a("2004"),n=a.n(r);n.a},"42ff":function(t,e,a){},4360:function(t,e,a){"use strict";var r=a("2b0e"),n=a("2f62"),i=a("bc3a"),s=a.n(i);const o={currentUser:{username:null,isAuth:!1}},u={currentUser:t=>t.currentUser},c={fetchCurrentUser({commit:t}){return new Promise((e,a)=>{s.a.get("/api/current-user").then(a=>{t("authRefresh",a.data),e(a)}).catch(e=>{t("authNotLoggedIn"),a(e)})})}},l={authRefresh(t,e){t.currentUser.username=e.username,t.currentUser.isAuth=e.isAuth},authNotLoggedIn(t){t.currentUser.username=null,t.currentUser.isAuth=!1}};var d={state:o,getters:u,actions:c,mutations:l};r["a"].use(n["a"]);e["a"]=new n["a"].Store({state:{unreadMessages:0},getters:{},mutations:{},actions:{},modules:{auth:d}})},"4ec6":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);var r=a("2b0e"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[t.mobileView?a("div",[a("NavbarMobile",{attrs:{showNav:t.showNav},on:{swap:function(e){return t.swap()}}})],1):t._e(),a("div",{staticClass:"content",class:{open:t.showNav}},[a("div",{staticClass:"top-bar"},[t.mobileView?a("div",{attrs:{id:"nav-icon"},on:{click:function(e){t.showNav=!t.showNav}}},[t._m(0)]):t._e(),t.mobileView?t._e():a("Navbar")],1),a("div",{attrs:{id:"top-spacing"}}),a("router-view")],1)])},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("i",[a("div",{staticClass:"icon-bar"}),a("div",{staticClass:"icon-bar"}),a("div",{staticClass:"icon-bar"})])}],s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"navbar"}},[a("ul",[t.currentUser.isAuth?a("li",[a("div",{attrs:{id:"welcome-message"}},[t._v("Welcome "+t._s(t.currentUser.username))])]):t._e(),a("li",[a("router-link",{attrs:{to:"/page/1"}},[t._v("Home")])],1),t.currentUser.isAuth?a("li",{staticClass:"nav-item"},[a("router-link",{attrs:{to:"/my-bids/page/1"}},[t._v("My bids")])],1):t._e(),t.currentUser.isAuth?a("li",{staticClass:"nav-item"},[a("router-link",{attrs:{to:"/my-auctions/page/1"}},[t._v("My offers")])],1):t._e(),t.currentUser.isAuth?a("li",{staticClass:"nav-item"},[a("router-link",{attrs:{to:"/my-history/page/1"}},[t._v("My history")])],1):t._e(),t.currentUser.isAuth?a("li",{staticClass:"nav-item"},[a("router-link",{attrs:{to:"/my-conversations"}},[t._v("My conversations")])],1):t._e(),t.currentUser.isAuth?a("li",[a("a",{staticClass:"log-item",on:{click:function(e){return t.logout()}}},[t._v("Log out")])]):t._e(),t.currentUser.isAuth?t._e():a("li",[a("router-link",{staticClass:"log-item",attrs:{to:"/login"}},[t._v("Log in")])],1),t.currentUser.isAuth?t._e():a("li",[a("router-link",{staticClass:"log-item",attrs:{to:"/register"}},[t._v("Register")])],1)])])},o=[],u=a("bc3a"),c=a.n(u),l=a("a18c"),d=a("2f62"),m={name:"Navbar",computed:{...Object(d["c"])(["currentUser"])},data(){return{}},methods:{...Object(d["b"])(["fetchCurrentUser"]),logout(){c.a.get("/api/logout").then(()=>{l["a"].push({name:"Login"})}).catch(t=>{console.log(t)})}}},p=m,h=(a("aaef"),a("2877")),v=Object(h["a"])(p,s,o,!1,null,"5707b0da",null),g=v.exports,f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"navbar-mobile"}},[a("ul",[t.currentUser.isAuth?a("li",[a("div",{attrs:{id:"welcome-message"}},[t._v("Welcome "+t._s(t.currentUser.username))])]):t._e(),a("li",{on:{click:function(e){return t.openOrCloseNavBar()}}},[a("router-link",{attrs:{to:"/page/1"}},[t._v("Home")])],1),t.currentUser.isAuth?a("li",{staticClass:"nav-item",on:{click:function(e){return t.openOrCloseNavBar()}}},[a("router-link",{attrs:{to:"/my-bids/page/1"}},[t._v("Bids")])],1):t._e(),t.currentUser.isAuth?a("li",{staticClass:"nav-item",on:{click:function(e){return t.openOrCloseNavBar()}}},[a("router-link",{attrs:{to:"/my-auctions/page/1"}},[t._v("My offers")])],1):t._e(),t.currentUser.isAuth?a("li",{staticClass:"nav-item",on:{click:function(e){return t.openOrCloseNavBar()}}},[a("router-link",{attrs:{to:"/my-history/page/1"}},[t._v("History")])],1):t._e(),t.currentUser.isAuth?a("li",{staticClass:"nav-item",on:{click:function(e){return t.openOrCloseNavBar()}}},[a("router-link",{attrs:{to:"/my-conversations"}},[t._v("Conversations")])],1):t._e(),t.currentUser.isAuth?a("li",{staticClass:"nav-item",on:{click:function(e){return t.openOrCloseNavBar()}}},[a("a",{on:{click:function(e){return t.logout()}}},[t._v("Log out")])]):t._e(),t.currentUser.isAuth?t._e():a("li",{staticClass:"nav-item",on:{click:function(e){return t.openOrCloseNavBar()}}},[a("router-link",{attrs:{to:"/login"}},[t._v("Log in")])],1),t.currentUser.isAuth?t._e():a("li",{staticClass:"nav-item",on:{click:function(e){return t.openOrCloseNavBar()}}},[a("router-link",{attrs:{to:"/register"}},[t._v("Register")])],1)])])},b=[],_={name:"Navbar",computed:{...Object(d["c"])(["currentUser"])},props:["showNav"],data(){return{}},methods:{...Object(d["b"])(["fetchCurrentUser"]),openOrCloseNavBar(){this.$emit("swap")},logout(){c.a.get("/api/logout").then(()=>{l["a"].push({name:"Login"})}).catch(t=>{console.log(t)})}}},y=_,w=(a("ad33"),Object(h["a"])(y,f,b,!1,null,"340742d2",null)),A=w.exports,D={components:{Navbar:g,NavbarMobile:A},data(){return{mobileView:!1,showNav:!1,windowWidth:window.outerWidth}},methods:{handleView(){this.mobileView=window.innerWidth<=600},swap(){this.showNav=!this.showNav}},created(){this.handleView()}},U=D,k=(a("5c0b"),Object(h["a"])(U,n,i,!1,null,null,null)),C=k.exports,x=a("4360");r["a"].config.productionTip=!1,new r["a"]({router:l["a"],store:x["a"],render:function(t){return t(C)}}).$mount("#app")},"5c0b":function(t,e,a){"use strict";var r=a("9c0c"),n=a.n(r);n.a},7144:function(t,e,a){},"7cb2":function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"auction-list"},[null!==t.auctions?a("div",[a("button",{attrs:{id:"btn-prev-page"},on:{click:function(e){return t.goToPreviousPage()}}},[t._v(" < ")]),a("button",{attrs:{id:"btn-next-page"},on:{click:function(e){return t.goToNextPage()}}},[t._v(" > ")])]):t._e(),a("ul",t._l(t.auctions,(function(e){return a("li",{key:e._id,staticClass:"auction-list"},[a("Auction",{attrs:{auction:e,currUser:t.currUser}})],1)})),0)])},n=[],i=a("bc3a"),s=a.n(i),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return null!==t.auction?a("div",{attrs:{id:"auction"}},["Bid"===t.auction.type?a("div",[a("h3",[t._v("Auction")])]):t._e(),"Buy"===t.auction.type?a("div",[a("h3",[t._v("Product")])]):t._e(),t.isEditMode?t._e():a("div",[a("AuctionDetails",{attrs:{auction:t.auction,currUser:t.currUser,timeLeft:t.timeLeft,socket:t.socket}})],1),t.isAuthAndIsOwnerAndIsNotStarted?a("div",[a("button",{attrs:{id:"btn-edit"},on:{click:function(e){return t.showEdit()}}},[t._v(" "+t._s(t.editButtonText)+" ")])]):t._e(),t.isEditMode?a("div",[a("AuctionEdit",{attrs:{auction:t.auction,currUser:t.currUser}})],1):t._e(),t.isAuthAndIsNotOwnerAndOnSale?a("button",{on:{click:function(e){return t.goToConversation()}}},[t._v(" Contact seller ")]):t._e()]):t._e()},u=[],c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"auction-details"}},[t._v(" Name: "+t._s(t.auction.name)),a("br"),t._v(" Seller: "+t._s(t.auction.seller)),a("br"),"Bid"===t.auction.type?a("div",["OnSale"===t.auction.status?a("div",[t._v(" Current price: $"+t._s(t.auction.price)),a("br"),t.isAnyTimeLeft?a("div",[t._v(" Time left: "+t._s(t.timeLeft)+" ")]):t._e(),""===t.auction.highestBidder?a("div",[t._v(" No one bid yet!"),a("br")]):a("div",[t._v(" Highest bidder: "+t._s(t.auction.highestBidder)),a("br")]),t.isLoggedAndNotSeller?a("div",[a("button",{on:{click:function(e){return t.bidItem()}}},[t._v(" Bid now! ")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.price,expression:"formData.price"}],staticClass:"input",attrs:{id:"price-input",type:"number",min:"0.01",step:"0.01",placeholder:"Your bid",size:"9",required:""},domProps:{value:t.formData.price},on:{input:function(e){e.target.composing||t.$set(t.formData,"price",e.target.value)}}})]):t._e()]):"Sold"===t.auction.status?a("div",[t._v(" Sold for: $"+t._s(t.auction.price)),a("br"),t._v(" Buyer: "+t._s(t.auction.highestBidder)+" ")]):"New"===t.auction.status?a("div",[t._v(" Starting price: $"+t._s(t.auction.price)),a("br"),t._v(" Duration: "+t._s(t.getDurationText)),a("br"),a("button",{attrs:{id:"btn-start"},on:{click:function(e){return t.startAuction()}}},[t._v("Start auction")])]):"Ignored"===t.auction.status?a("div",[t._v(" No buyer"),a("br")]):t._e()]):"Buy"===t.auction.type?a("div",["OnSale"===t.auction.status?a("div",[t._v(" Price: $"+t._s(t.auction.price)),a("br"),t.isLoggedAndNotSeller?a("div",[a("button",{on:{click:function(e){return t.buyItem()}}},[t._v(" Buy now! ")]),a("br")]):t._e()]):"Sold"===t.auction.status?a("div",[t._v(" Sold for: $"+t._s(t.auction.price)),a("br"),t._v(" Buyer: "+t._s(t.auction.highestBidder)+" ")]):"New"===t.auction.status?a("div",[t._v(" Price: $"+t._s(t.auction.price)),a("br"),a("button",{attrs:{id:"btn-start"},on:{click:function(e){return t.startAuction()}}},[t._v("Start auction")])]):t._e()]):t._e(),t.errorMessage.isVisible?a("div",{attrs:{id:"error-message"}},[t._v(" "+t._s(t.errorMessage.content)+" ")]):t._e()])},l=[],d=a("2f62"),m=a("a18c"),p={name:"AuctionDetails",props:["auction","currUser","timeLeft","socket"],data(){return{errorMessage:{isVisible:!1,content:"Your bid is invalid"},formData:{id:this.auction._id,price:"",bidders:[this.currUser.username],highestBidder:""}}},computed:{...Object(d["c"])(["currentUser"]),isLoggedAndNotSeller(){const t=this.currUser;return t.isAuth&&this.auction.seller!==t.username},isAnyTimeLeft(){return new Date(this.auction.duration).getTime()>=(new Date).getTime()},getDurationText(){switch(this.auction.duration){case 1e4:return"10 Seconds";case 36e5:return"1 Hour";case 108e5:return"3 Hours";case 216e5:return"6 Hours";case 432e5:return"12 Hours";case 864e5:return"1 Day";case 2592e5:return"3 Hours";case 6048e5:return"1 Week";default:return"DEFAULT VALUE"}}},methods:{startAuction(){s.a.patch("/api/start",{id:this.auction._id}).then(()=>{this.socket.emit("start-auction",{id:this.auction._id,username:this.currentUser.username}),m["a"].push({name:"Home",params:{page:1}})}).catch(t=>{console.log(t)})},bidItem(){this.formData.price<=this.auction.price?(this.errorMessage.isVisible=!0,setTimeout(()=>{this.errorMessage.isVisible=!1},3e3)):this.socket.emit("new-bid",{id:this.auction._id,highestBidder:this.currentUser.username,price:this.formData.price})},buyItem(){this.socket.emit("new-buy",{id:this.auction._id,status:"Sold",highestBidder:this.currUser.username})}}},h=p,v=(a("d4ae"),a("2877")),g=Object(v["a"])(h,c,l,!1,null,"e2591518",null),f=g.exports,b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"auction-edit"},[a("br"),a("form",{on:{submit:function(e){return e.preventDefault(),t.updateAuction()}}},[a("label",{attrs:{for:"name-input"}},[t._v("Name: ")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.name,expression:"formData.name"}],staticClass:"input",attrs:{id:"name-input",type:"text",minLength:"3",placeholder:"Name",required:""},domProps:{value:t.formData.name},on:{input:function(e){e.target.composing||t.$set(t.formData,"name",e.target.value)}}}),a("br"),a("br"),a("label",{attrs:{for:"price-input"}},[t._v("Price: $ ")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.price,expression:"formData.price"}],staticClass:"input",attrs:{id:"price-input",type:"number",min:"0.01",step:"0.01",placeholder:"Price",size:"9",required:""},domProps:{value:t.formData.price},on:{input:function(e){e.target.composing||t.$set(t.formData,"price",e.target.value)}}}),a("br"),a("br"),a("div",{staticClass:"select-type"},[a("label",{attrs:{for:"type-input"}},[t._v("Type: ")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.formData.type,expression:"formData.type"}],attrs:{id:"type-input"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.formData,"type",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"Bid"}},[t._v("Bid")]),a("option",{attrs:{value:"Buy"}},[t._v("Buy now")])]),a("br"),a("br")]),"Bid"===t.formData.type?a("div",[a("label",{attrs:{for:"duration-input"}},[t._v("Duration: ")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.formData.duration,expression:"formData.duration"}],attrs:{id:"type-input"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.formData,"duration",e.target.multiple?a:a[0])}}},t._l(t.options,(function(e){return a("option",{key:e.text,domProps:{value:e.value}},[t._v(" "+t._s(e.text)+" ")])})),0)]):t._e(),a("br"),a("button",{attrs:{id:"btn-save",type:"submit"}},[t._v("Save changes")])]),a("br"),a("button",{attrs:{id:"btn-delete"},on:{click:function(e){return t.deleteAuction()}}},[t._v("Remove auction")]),a("br"),a("br")])},_=[],y={name:"AuctionEdit",props:["auction","currUser"],data(){return{options:[{text:"10 Seconds",value:1e4},{text:"1 Hour",value:this.calculateData(1)},{text:"3 Hours",value:this.calculateData(3)},{text:"6 Hours",value:this.calculateData(6)},{text:"12 Hours",value:this.calculateData(12)},{text:"1 Day",value:this.calculateData(24)},{text:"3 Days",value:this.calculateData(72)},{text:"1 Week",value:this.calculateData(168)}],formData:{id:this.auction._id,name:this.auction.name,price:this.auction.price,type:this.auction.type,duration:this.getDuration(),seller:this.currUser.username}}},methods:{getDuration(){return"Buy"===this.auction.type?this.calculateData(1):this.auction.duration},calculateData:function(t){const e=36e5,a=e*t;return a},updateAuction(){"Buy"===this.formData.type&&(this.formData.duration=null),s.a.patch("/api/auction",this.formData).then(()=>{m["a"].push({name:"Home",params:{page:1}})}).catch(t=>{console.log(t)})},deleteAuction(){const t={id:this.auction._id};s.a.delete("/api/auction",t).then(()=>{m["a"].push({name:"Home",params:{page:1}})}).catch(t=>{console.log(t)})}}},w=y,A=Object(v["a"])(w,b,_,!1,null,"aa3ce488",null),D=A.exports,U=a("8055"),k=a.n(U),C={name:"Auction",components:{AuctionDetails:f,AuctionEdit:D},props:["auction","currUser"],data(){return{socket:k()(),isEditMode:!1,editButtonText:"Edit",timeLeft:null,addressBar:window.location.href}},computed:{...Object(d["c"])(["currentUser"]),isAuthAndIsOwnerAndIsNotStarted(){return this.currUser.isAuth&&this.auction.seller===this.currUser.username&&"New"===this.auction.status},isAuthAndIsNotOwnerAndOnSale(){return this.currUser.isAuth&&this.auction.seller!==this.currUser.username&&"OnSale"===this.auction.status}},methods:{showEdit(){this.isEditMode=!this.isEditMode,this.isEditMode?this.editButtonText="Cancel changes":this.editButtonText="Edit"},goToConversation(){const t={otherUser:this.auction.seller};s.a.post("/api/conversation/exists",t).then(t=>{null===t.data?this.createConversation():m["a"].push({name:"Conversation",params:{conversation:t.data}})}).catch(t=>{console.log(t)})},createConversation:function(){const t={otherUser:this.auction.seller};s.a.post("/api/conversation",t).then(t=>{null!==t.data?m["a"].push({name:"Conversation",params:{conversation:t.data}}):console.log("Failed to create conversation")}).catch(t=>{console.log(t)})},leaveSocket(){this.currUser.isAuth&&"Bid"===this.auction.type&&this.socket.emit("leave-auction",{id:this.auction._id,username:this.currUser.username})}},created(){"OnSale"===this.auction.status&&"Bid"===this.auction.type&&null!==this.auction.duration&&new Date(this.auction.duration).getTime()>=(new Date).getTime()&&(this.timer=setInterval(()=>{const t=(new Date).getTime(),e=new Date(this.auction.duration),a=e-t,r=Math.floor(a%864e5/36e5),n=Math.floor(a%36e5/6e4),i=Math.floor(a%6e4/1e3);let s=r.toString(),o=n.toString(),u=i.toString();1===s.length&&(s="0"+s),1===o.length&&(o="0"+o),1===u.length&&(u="0"+u),this.timeLeft=`${s}:${o}:${u}`,a<=0&&clearInterval(this.timer)})),this.currUser.isAuth&&"OnSale"===this.auction.status&&this.socket.emit("join-auction",{id:this.auction._id,username:this.currentUser.username}),this.socket.on("new-bid",t=>{console.log(`New bid from ${t.highestBidder} has arrived!`),this.auction.price=t.price,this.auction.highestBidder=t.highestBidder}),this.socket.on("new-buy",t=>{console.log(`A product has been bought by ${t.highestBidder}!`),this.auction.status="Sold",this.auction.highestBidder=t.highestBidder}),window.onbeforeunload=()=>{this.socket.emit("leave-auction",{id:this.auction._id,username:this.currUser.username})}},beforeDestroy(){this.leaveSocket()}},x=C,S=Object(v["a"])(x,o,u,!1,null,"5cd155b8",null),N=S.exports,O={name:"AuctionList",components:{Auction:N},props:["apiString"],data(){return{currUser:this.$store.getters.currentUser,auctions:null,currentPage:0,nextPage:!1,previousPage:!1}},methods:{updateButtonVisibility(){this.nextPage?document.getElementById("btn-next-page").style.visibility="visible":document.getElementById("btn-next-page").style.visibility="hidden",this.previousPage?document.getElementById("btn-prev-page").style.visibility="visible":document.getElementById("btn-prev-page").style.visibility="hidden"},goToNextPage(){this.currentPage++,this.changePage(this.currentPage)},goToPreviousPage(){this.currentPage--,this.changePage(this.currentPage)},changePage(t){s.a.get(this.apiString+this.currentPage).then(t=>{if(this.auctions=t.data.auctions,this.nextPage=t.data.nextPage,this.previousPage=t.data.previousPage,history.pushState){var e=window.location.protocol+"//"+window.location.host+"/page/"+this.currentPage;window.history.pushState({path:e},"",e)}}).catch(t=>{console.log(t)})}},created(){this.currentPage=parseInt(this.$route.params.page),s.a.get(this.apiString+this.currentPage).then(t=>{this.auctions=t.data.auctions,this.nextPage=t.data.nextPage,this.previousPage=t.data.previousPage}).catch(t=>{console.log(t)})},updated(){this.updateButtonVisibility()}},P=O,B=(a("2df4"),Object(v["a"])(P,r,n,!1,null,"3c8d2887",null));e["a"]=B.exports},9490:function(t,e,a){},"9c0c":function(t,e,a){},a18c:function(t,e,a){"use strict";var r=a("2b0e"),n=a("8c4f"),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"home"},[a("h2",{staticClass:"list-type-message"},[t._v("Available auctions")]),a("AuctionList",{attrs:{apiString:t.apiString}})],1)},s=[],o=a("7cb2"),u=a("2f62"),c={name:"Home",components:{AuctionList:o["a"]},data(){return{apiString:"/api/auctions/page/"}},computed:{...Object(u["c"])(["currentUser"])}},l=c,d=a("2877"),m=Object(d["a"])(l,i,s,!1,null,"0b39f01f",null),p=m.exports,h=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"login"},[a("h2",[t._v("Log in")]),a("hr"),a("form",{ref:"form",on:{submit:function(e){return e.preventDefault(),t.handleSubmit()}}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.username,expression:"formData.username"}],attrs:{type:"text",name:"username",id:"username",placeholder:"Username",minLength:"3",required:""},domProps:{value:t.formData.username},on:{input:function(e){e.target.composing||t.$set(t.formData,"username",e.target.value)}}}),a("br"),a("br"),a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.password,expression:"formData.password"}],attrs:{type:"password",name:"password",id:"password",placeholder:"Password",required:""},domProps:{value:t.formData.password},on:{input:function(e){e.target.composing||t.$set(t.formData,"password",e.target.value)}}}),a("br"),a("br"),a("button",{attrs:{type:"submit"}},[t._v("Log in")])]),a("div",{attrs:{id:"error-message"}})])},v=[],g=a("bc3a"),f=a.n(g),b={name:"Login",data(){return{formData:{username:"",password:""}}},computed:{...Object(u["c"])(["currentUser"])},methods:{...Object(u["b"])(["fetchCurrentUser"]),handleSubmit(){f.a.post("/api/login",this.formData).then(t=>{lt.push({name:"Home",params:{page:1}})}).catch(t=>{const e=document.getElementById("error-message");401===t.response.status?(e.style.visibility="visible",e.innerHTML="Invalid credentials"):(e.style.visibility="visible",e.innerHTML="An error occured, try again later")})}}},_=b,y=(a("3fc8"),Object(d["a"])(_,h,v,!1,null,"2015d661",null)),w=y.exports,A=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"register"},[a("h2",[t._v("Register")]),a("hr"),a("form",{on:{submit:function(e){return e.preventDefault(),t.handleSubmit()}}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.user.username,expression:"user.username"}],attrs:{type:"text",name:"username",id:"username",placeholder:"Username",minLength:"3",required:""},domProps:{value:t.user.username},on:{input:function(e){e.target.composing||t.$set(t.user,"username",e.target.value)}}}),a("br"),a("br"),a("input",{directives:[{name:"model",rawName:"v-model",value:t.user.password,expression:"user.password"}],attrs:{type:"password",name:"password",id:"password",placeholder:"Password",required:""},domProps:{value:t.user.password},on:{input:function(e){e.target.composing||t.$set(t.user,"password",e.target.value)}}}),a("br"),a("br"),a("button",{attrs:{type:"submit"}},[t._v("Register")])])])},D=[],U={name:"Register",data(){return{user:{username:"",password:""}}},methods:{handleSubmit(){f.a.post("api/register",this.user).then(()=>{lt.push({name:"Login"})}).catch(t=>{console.log(t)})}}},k=U,C=(a("41c0"),Object(d["a"])(k,A,D,!1,null,"1250ae2a",null)),x=C.exports,S=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"my-bids"},[a("h2",{staticClass:"list-type-message"},[t._v("Bids")]),a("AuctionList",{attrs:{apiString:t.apiString}})],1)},N=[],O={name:"MyBids",components:{AuctionList:o["a"]},data(){return{apiString:"/api/my-bids/page/"}}},P=O,B=Object(d["a"])(P,S,N,!1,null,null,null),$=B.exports,L=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"my-auctions"},[a("h2",{staticClass:"list-type-message"},[t._v("My offers")]),a("AuctionList",{attrs:{apiString:t.apiString}}),t.currentUser.isAuth?a("div",{attrs:{id:"btn-create-auction"}},[a("button",{on:{click:function(e){return t.goToAuctionForm()}}},[t._v("Create auction")])]):t._e()],1)},M=[],j={name:"MyAuctions",components:{AuctionList:o["a"]},data(){return{apiString:"/api/my-auctions/page/"}},computed:{...Object(u["c"])(["currentUser"])},methods:{goToAuctionForm(){lt.push({name:"Auction"})}}},E=j,T=(a("ad5c"),Object(d["a"])(E,L,M,!1,null,"55196068",null)),I=T.exports,H=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"auction-form"},[a("h2",[t._v("Create auction")]),a("form",{on:{submit:function(e){return e.preventDefault(),t.createAuction()}}},[a("label",{attrs:{for:"name-input"}},[t._v("Name: ")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.name,expression:"formData.name"}],staticClass:"input",attrs:{id:"name-input",type:"text",minLength:"3",placeholder:"Name",required:""},domProps:{value:t.formData.name},on:{input:function(e){e.target.composing||t.$set(t.formData,"name",e.target.value)}}}),a("br"),a("br"),a("label",{attrs:{for:"price-input"}},[t._v("Price: $ ")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.price,expression:"formData.price"}],staticClass:"input",attrs:{id:"price-input",type:"number",min:"0.01",step:"0.01",placeholder:"Price",size:"9",required:""},domProps:{value:t.formData.price},on:{input:function(e){e.target.composing||t.$set(t.formData,"price",e.target.value)}}}),a("br"),a("br"),a("div",{staticClass:"select-type"},[a("label",{attrs:{for:"type-input"}},[t._v("Type: ")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.formData.type,expression:"formData.type"}],attrs:{id:"type-input"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.formData,"type",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"Bid"}},[t._v("Bid")]),a("option",{attrs:{value:"Buy"}},[t._v("Buy now")])]),a("br"),a("br")]),"Bid"===t.formData.type?a("div",[a("label",{attrs:{for:"duration-input"}},[t._v("Duration: ")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.formData.duration,expression:"formData.duration"}],attrs:{id:"type-input"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.formData,"duration",e.target.multiple?a:a[0])}}},t._l(t.options,(function(e){return a("option",{key:e.text,domProps:{value:e.value}},[t._v(" "+t._s(e.text)+" ")])})),0)]):t._e(),a("br"),a("label",{attrs:{for:"jack"}},[t._v("Start auction")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.isStartAuction,expression:"isStartAuction"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.isStartAuction)?t._i(t.isStartAuction,null)>-1:t.isStartAuction},on:{change:function(e){var a=t.isStartAuction,r=e.target,n=!!r.checked;if(Array.isArray(a)){var i=null,s=t._i(a,i);r.checked?s<0&&(t.isStartAuction=a.concat([i])):s>-1&&(t.isStartAuction=a.slice(0,s).concat(a.slice(s+1)))}else t.isStartAuction=n}}}),a("br"),a("br"),a("button",{attrs:{type:"submit"}},[t._v("Create")]),a("br"),a("br")])])},V=[],R=a("8055"),q=a.n(R),W={name:"AuctionForm",data(){return{socket:q()(),options:[{text:"10 Seconds",value:1e4},{text:"1 Hour",value:this.calculateData(1)},{text:"3 Hours",value:this.calculateData(3)},{text:"6 Hours",value:this.calculateData(6)},{text:"12 Hours",value:this.calculateData(12)},{text:"1 Day",value:this.calculateData(24)},{text:"3 Days",value:this.calculateData(72)},{text:"1 Week",value:this.calculateData(168)}],isStartAuction:!1,formData:{name:null,price:null,type:"Bid",status:"New",duration:this.calculateData(1)}}},methods:{calculateData:function(t){const e=36e5,a=e*t;return a},createAuction(){f.a.post("/api/auction",this.formData).then(t=>{this.isStartAuction&&this.startAuction(t.data._id),lt.push({name:"MyAuctions",params:{page:1}})}).catch(t=>{console.log(t)})},startAuction(t){f.a.patch("/api/start",{id:t}).then(()=>{this.socket.emit("start-auction",{id:t,username:this.$store.getters.currentUser.username})}).catch(t=>{console.log(t)})}}},F=W,z=(a("d71c"),Object(d["a"])(F,H,V,!1,null,"077f297a",null)),J=z.exports,Y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return null!==t.conversation?a("div",{staticClass:"conversation"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.messageInput,expression:"messageInput"}],attrs:{id:"message-content",type:"text",placeholder:"Content"},domProps:{value:t.messageInput},on:{input:function(e){e.target.composing||(t.messageInput=e.target.value)}}}),a("button",{attrs:{id:"btn-send"},on:{click:function(e){return t.sendMessage()}}},[t._v("Send")]),0===t.conversation.messages.length?a("div",[t._v(" No messages ")]):t._l(t.conversation.messages,(function(e){return a("div",{key:e._id},[a("strong",[t._v(t._s(e.handle))]),t._v(": "+t._s(e.content)+" ")])}))],2):t._e()},G=[],K={name:"Conversation",data(){return{socket:q()(),messageInput:"",conversation:null}},computed:{...Object(u["c"])(["currentUser"])},methods:{getOtherUser(t){return t[0]===this.currentUser.username?t[1]:t[0]},sendMessage(){if(""===this.messageInput)console.log("Your message is empty!");else{const t={id:this.conversation._id,handle:this.currentUser.username,content:this.messageInput,otherUser:this.getOtherUser(this.conversation.participants)};this.socket.emit("new-message",t),this.messageInput=""}},leaveSocket(){this.currentUser.isAuth&&(this.socket.emit("leave-conversation",{id:this.conversation._id,username:this.currentUser.username}),console.log("Left conversation!"))}},created(){if(void 0===this.$route.params.conversation)return void lt.push({name:"MyConversations"});this.conversation=this.$route.params.conversation,this.currentUser.isAuth&&(this.socket.emit("join-conversation",{id:this.conversation._id,username:this.currentUser.username}),console.log("Joined a conversation!")),this.socket.on("new-message",t=>{this.conversation.messages.push(t),console.log(`New message from ${t.handle} has arrived!`)}),window.onbeforeunload=()=>{this.leaveSocket()};const t=this.conversation.messages;t.length>=1&&!t[t.length-1].seen.includes(this.currentUser.username)&&this.socket.emit("update-conversation-seen",{id:this.conversation._id})},beforeDestroy(){null!==this.$route.params.conversation&&this.leaveSocket()}},Q=K,X=(a("a78c"),Object(d["a"])(Q,Y,G,!1,null,"29e99b75",null)),Z=X.exports,tt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"conversations"},[a("h2",{staticClass:"list-type-message"},[t._v("Conversations")]),a("ul",t._l(t.conversations,(function(e){return a("li",{key:e._id,staticClass:"conversation-list"},[a("h3",[t._v("Conversation")]),t._v(" "+t._s(t.getOtherUser(e.participants))+" "),a("button",{attrs:{id:"btn-show-conversation"},on:{click:function(a){return t.goToConversation(e)}}},[t._v(" Open ")]),t.isAnyMessageUnRead(e.messages)?a("strong",[t._v(" Unread messages ")]):t._e()])})),0)])},et=[],at={name:"MyConversations",data(){return{conversations:null}},computed:{...Object(u["c"])(["currentUser"])},methods:{isAnyMessageUnRead(t){const e=t=>!t.seen.includes(this.currentUser.username);return t.some(e)},getOtherUser(t){return t[0]===this.currentUser.username?t[1]:t[0]},goToConversation(t){lt.push({name:"Conversation",params:{conversation:t}})}},created(){f.a.get("/api/conversations").then(t=>{this.conversations=t.data}).catch(t=>{console.log(t)})}},rt=at,nt=(a("e78a"),Object(d["a"])(rt,tt,et,!1,null,"3ce50f4a",null)),it=nt.exports,st=a("4360");r["a"].use(n["a"]);const ot=[{path:"/page/:page(\\d+)",name:"Home",component:p},{path:"/login",name:"Login",component:w},{path:"/register",name:"Register",component:x},{path:"/my-bids/page/:page(\\d+)",name:"MyBids",component:$},{path:"/my-auctions/page/:page(\\d+)",name:"MyAuctions",component:I},{path:"/my-history/page/:page(\\d+)",name:"MyHistory",component:function(){return a.e("chunk-2d213e2d").then(a.bind(null,"af1c"))}},{path:"/auction",name:"Auction",component:J},{path:"/conversation",name:"Conversation",component:Z},{path:"/my-conversations",name:"MyConversations",component:it}],ut=new n["a"]({mode:"history",base:"/",routes:ot}),ct=t=>{const e=[];return ut.options.routes.forEach(t=>{e.push(t.name)}),e.includes(t)};ut.beforeEach(async(t,e,a)=>{await st["a"].dispatch("fetchCurrentUser"),ct(t.name)?st["a"].getters.currentUser.isAuth?st["a"].getters.currentUser.isAuth&&("Register"===t.name||"Login"===t.name?a({name:"Home",params:{page:1}}):a()):"Register"===t.name||"Login"===t.name||"Home"===t.name?a():a({name:"Login"}):a({name:"Home",params:{page:1}})});var lt=e["a"]=ut},a78c:function(t,e,a){"use strict";var r=a("1536"),n=a.n(r);n.a},aaef:function(t,e,a){"use strict";var r=a("b87a"),n=a.n(r);n.a},ad33:function(t,e,a){"use strict";var r=a("7144"),n=a.n(r);n.a},ad5c:function(t,e,a){"use strict";var r=a("42ff"),n=a.n(r);n.a},b87a:function(t,e,a){},bebe:function(t,e,a){},d4ae:function(t,e,a){"use strict";var r=a("4ec6"),n=a.n(r);n.a},d71c:function(t,e,a){"use strict";var r=a("3fa4"),n=a.n(r);n.a},e78a:function(t,e,a){"use strict";var r=a("bebe"),n=a.n(r);n.a}});
//# sourceMappingURL=app.6c13b545.js.map